---
title: "HW2"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{HW2}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, include = FALSE}
library(tidyverse)
library(bookdown)
library(ggplot2)
```

```{r import data, include = FALSE}
country_population <- readr::read_csv("https://raw.githubusercontent.com/linnykos/561_s2024_public/main/HW2_files/country_population.csv")

country_birth <- readr::read_csv("https://raw.githubusercontent.com/linnykos/561_s2024_public/main/HW2_files/country_birth.csv")

penguins <- readr::read_csv("https://raw.githubusercontent.com/linnykos/561_s2024_public/main/HW2_files/palmerpenguins.csv")

source("https://raw.githubusercontent.com/linnykos/561_s2024_public/main/HW2_files/random_graph_functions.R")
```

## Question 0

## Question 1 

### Question 1A

```{r}
q1a <- country_population %>% 
  filter(
    year >= 1990, 
    year<= 2010
  ) %>%
  group_by(
    iso3c,
    country
  ) %>%
  summarise(
    mean_population = mean(population)
  )

head(q1a)
```

### Question 1B

```{r}
q1b <- country_birth %>% 
  filter(
    year >= 1990, 
    year<= 2010
  ) %>%
  select(
    iso3c, 
    year, 
    life_expect
  ) %>% 
  drop_na() %>%
  group_by(
    iso3c
  ) %>%
  summarise(
    min_life_expect = min(life_expect), 
    max_life_expect = max(life_expect)
  ) %>% 
  ungroup() %>%
  mutate(
    range_life_expect = max_life_expect - min_life_expect
  )

head(q1b)
```

### Question 1C

```{r}
country_both <- inner_join(x = q1a, y = q1b, by = "iso3c")

head(country_both, n=10)
```

Num rows: `r nrow(country_both)` 

Num cols: `r ncol(country_both)` 

## Question 2

### Question 2A

```{r, fig.dim = c(8, 6)}
penguins %>%
  ggplot(aes(x = bill_depth_mm, y = bill_length_mm, 
             color = species)) +
  geom_point() +
  scale_color_manual(values=c("Adelie" = "cornflowerblue",
                              "Chinstrap" = "coral2",
                              "Gentoo" = "goldenrod3")) +
  labs(x = "Bill Depth (mm)", 
       y = "Bill Length (mm)", 
       title = paste0("Relation Among ", as.character(nrow(penguins))," Penguins"))
```

### Question 2B

```{r, fig.dim = c(8, 6)}
penguins %>%
  ggplot(aes(x = bill_depth_mm, y = bill_length_mm, 
             color = species)) +
  geom_point(alpha=0.5) +
  scale_color_manual(values=c("Adelie" = "cornflowerblue",
                              "Chinstrap" = "coral2",
                              "Gentoo" = "goldenrod3")) +
  geom_smooth(method = "lm", se = FALSE) + 
  labs(x = "Bill Depth (mm)", 
       y = "Bill Length (mm)", 
       title = paste0("Relation Among ", as.character(nrow(penguins))," Penguins")) +
  facet_wrap(~species, nrow = 1)
```

## Question 3

### Question 3A

generate_random_graph() creates an n by n matrix, where n is an integer input to the function. The entries in this matrix are randomly selected such that they are 0 90% of the time and 1 10% of the time. To symmetrisize the matrix, add the matrix to its inverse and replace all non-zero entries with 1. Additionally, set the diagonal of the matrix to all 1. Then, take the first 20% of the rows and columns (rounded up to nearest whole number), and set all equal to 1. The nodess are then shuffled and the fumction returms the shuffled matrix and a list of numbers to undo the shuffling. 

### Question 3B

pivot_longer_heatmap() creates a new row for every entry in adj_mat. If adj_mat is 20x20, it will create a row for [1,1], where X = 1, Y = 1, and value is the entry at this position in adj_mat, another row for [1,2], .... There will be n x n rows in the result.

### Question 3C

```{r}
set.seed(2)

result <- generate_random_graph(n = 20)
adj_mat <- result$adj_mat
mat_long <- pivot_longer_heatmap(adj_mat)
ggplot(aes(x=X, y=Y, fill=as.factor(Value)), data=mat_long) + 
  geom_tile() + 
  coord_fixed(ratio = 1) + 
  scale_fill_manual(values = c("1" = "coral2", "0" = "palegoldenrod")) + 
  labs(fill = "Value")
```

### Question 3D

```{r}
adj_mat2 <- result$adj_mat[result$rev_order, result$rev_order]
mat_long <- pivot_longer_heatmap(adj_mat2)
ggplot(aes(x=X, y=Y, fill=as.factor(Value)), data=mat_long) + 
  geom_tile() + 
  coord_fixed(ratio = 1) + 
  scale_fill_manual(values = c("1" = "coral2", "0" = "palegoldenrod")) + 
  labs(fill = "Value")
```
The dense red at the bottom left is the clique that was introduced in the generate_random_graph code. 

## Question 4

## Question 5
